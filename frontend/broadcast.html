<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML>
    <HEAD>
        <style type = "text/css">
        .wrapper {
            text-align: center;
        }
        .split {
            height: 100%;
            width: 50%;
            position: fixed;
            z-index: 1;
            top: 0;
            overflow-x: hidden;
            padding-top: 20px;
        }
        .left {
            left: 0;
        }
        .right {
            right: 0;
        }
        .actionButton {
            display: block;
            text-align: center;
            position: absolute;
            top: 20%;
            height: 40%;
            left: 10%;
            width: 60%;
            font-size: xx-large;
            font-weight: bold;
            margin: 0 auto;
        }
        .selection {
            display: block;
            position: absolute;
            top: 5%;
            left: 10%;
            right: 0%;
            height: 80%;
            font-size: x-large;
            font-weight: bold;
            margin: 0 auto;
            text-align: center;
            border-style: dashed;
            padding: 20px;
        }
        h3 {
            text-decoration: underline;
        }
        </style>
        <TITLE>
            Gruppennachricht abschicken
        </TITLE>
        <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
    </HEAD>
    <BODY>
        <div class="split left">
            <div class="selection">
                <h3>Gruppennachricht abschicken</h3>
                <p id="preparedError" hidden>Fehler! Konnte vorbereitete Nachrichten nicht laden!</p>
                <ul id="smsList">
                </ul>
            </div>
        </div>
        <div class="split right">
            <div class="wrapper">
                <button id="sendButton" class="actionButton">SMS senden</button>
            </div>
        </div>
        <script>
        function sendAjax(url, type="GET", dataType="text") {
            var dfd = $.Deferred();
            $.ajax({
                type: type,
                url: url,
                dataType: dataType,
                success: (e) => dfd.resolve(e),
                error: (e) => dfd.reject(e),
            });
            return dfd.promise();
        }
        $("#sendButton").click(e => {

        });
        sendAjax("getPreparedSMS")
        .done(lines => {
            const lis = lines.map(line => $("<li>").append($("<a>").text(line)));
            $('#smsList').append(lis);
        })
        .fail(e =>  {
            $("#preparedError").show();
            $("#sendButton" ).prop( "disabled", true );
        })
        </script>
    </BODY>
</HTML>
